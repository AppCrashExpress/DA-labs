#include <iostream>
#include <string>
#include <chrono>
#include <cstdlib>
#include "SuffTree.h"
using namespace NSuff;

int main() {

    std::string input("ACTTATGCTTGGATACCCCTCGAACTGAGTGAGGGTCATCCCAAGGGGATCCCTTAAAGGAATCAGTCCCCGCGTCGAATCAGCAATGGAGTGCGAGGACATGGCAGCAACACCATGGAGATCCTATAGCCGATCTCCTAGTACAACGTCTTTGCATGCGACTCCCACGAGGTACCGCCACTTGTTGTCGACAGCTCTTGACGGCATTGTTCTAAAAGTATAAATGAAAGCACCTATACATAATAAGACGAATCATAGGGATAATGCCGCGGGGAGATTGTCACCTAAATTAAGTTTGCGCCTCACGAAAAGTTGTTGAGCCCGAGACCTATGGGCAAAAGAATAAAGACCCGTATGAACTCACGTGCAGAAAAGCAACAAGCGGTGCTCGGGTACTATTTTATTGGTCTTTCCTTAAATGCAGGTTGAAACGGGCAAAAATTCGGATGCGCACTCCCGCGGACAAGCATAAGAACTTAACCATACAAACACATTGACGCTGGGTTGGAAAGTTCGCATCCCCTACCGTGCGGGTTCTACCGGTTGACGAATGCATGAGTGATATAACACTCTTAACCATACGGGTTCGGATCTGAAACTCTAAACACGTCATAAGGCCCTGGAAGCTGAAAAAGACAGGGGTCGTATTAACCTGCCATTGGGTGACCCGAGCTTCTGTATCACGCCAGTATGAGTTTGCGGCACATTTCTTGCTTGACATCAAGCTTTTTATTATAATGACGCTAAGTGATAGGTAGGCGTAATTCTCTGGGCCGACCCGTAATGTAGTCTGTTCTGGCCAGGCTCCGATGAGGAAATATAAATACCAAGTCCTACACTGAGAACAGAGGAACTTTATTATCGGACTGTAGAGCACACCTTAATTTATATCTGTCTGCAGCTCAAGTATGGCCGGGATAGACACTAGCGACCCAAAGAACAAGTCCAGTCGATGCAGTTTTCGTTTATAGTGGCCACAATAAAGCACTATGAAGCAACCGCCACAACTCCGCCCAGCCCTCGAAGGTTTAAGAGTAGGCCCTGGTTCGTATATTTCCGTCGAACATTCTACATGACTATCGGTGCCTTATCACGCGGATAATCGATGGTGTGTAAGGAATTTATTACACCGCAGTCCCCTTGCACCGGGGGCGAGCACCTCAGTCACCGAAGATTTGGCTCTAGCGACTAGGGTTGAAACACGTCTTAGCATCTCGTGTCGACAGGGTGTAGGTAGCCCAGATTAGTGTTCCAACTCGTTTTGACCACTCTGGATCACAAGACAGTATCACATCTTGTACCACGATTCCCGCCGGACACGGCGGGATTAACACCCCAGGTCCAGAGACTGTTAGAATGCTATCAGTGCGACCTACTAATTTACCCTAATTCGCATTAGCCGAATTATGCCAAGCTACGGCGGACTGCTGATGGACTAGTACATGTGGCTACCGTACCATACTTCGCGACCTCTGGGTCTGTTTTGAAACAGGGTAGGCCTAGCACTTAGTGTGAGGCAAAATATCTGCCCAGTAATATCGAAGAATCACATATCAAAATCTAACTATCCCTGCACTTTGTGTTTTTGGTTCGGAGGAGGTAAACTGCGCAAGCTCATAGCGATATCGTAGTATCAACGATGTACCTCCAAGTCCTCAATGGCTGGTGGTAAATGGGAGCAGGGTCACATTAAGTAATCTGCCGATCGACCAGAGAGCCGGAGGTATCCGTGTGTACGTGAATTGTTTTAGTACGCAGCGGATTCGCATCTTGGCACCATCTCTCGGAGCCATTTGGAAGGAAACCAATCGCACGCCTACGGTAACGTTCACCTGGACTATGTCAGCAAGCACGAGCGTTTATCCCTTAGTGCGAAATGAGAGCTAGGTGATGCTCGGTCTTTTCTAGAGCGGTGCCTATGGGACACAATGGTATAAAGTTGTATGAGCTTTACCTTCAATAGCACCTTCCTTACGGTCCTATCGATGCAAAATGGTCAGATCTAAAGCACCGCGGGAAATTCGACCTGGCACGTATGGGAGAAGAAGGAATACCTTAGTAGCCCCCAGGTAACTCCACGTATGTCCAGAGAATGTGTACAGACCGATACTGCGACTCCAGGAGAAGTTGACACTTCTGCCAATGAAGCGCGTCTATTCATTCAAGAGCGTCCCGGACTAAATATACCGGATTATTCCCTCATGGAAAGCCCCAAACTCATTCTAACTAATTGTGACTTTCCCGACACACCGGTTTCGTTCGTGTGAACCCGGTCCCGGAGGGATATTGACCAACTCACTCCACGCGTTATAATGGCGAACTGGGACTCAGCGTGGCGACCAAACGCACCGTCAGCGTAATGGATTGCGAGCCAATAGGTAGTAGCTCAGGACCCTTTGTGAAGATAACGCAGTGCCCAGGAGCGCTATGGACCAAGACTGCGCCGTCCGAAAAGGTACGACTGGGGCGAATAGTCTAGGCAAGGTCCTACGCAGATACTGGGGTTCTAATCCCTCTATAAGCGGCTTGGCGCCGCAACATGCACAGCGCTATAAAGCGTCGTTCCACCATAACTTACGAGAGTGTAGGATGATGACATACCCGGCTTTAGCTCTGCTGCTACATGTATGCCCCCTACACGCTGCGCGTAATTAAAACGGCTACAGGCTTAAGGCAATAGCGCCCGCAATGGTCGCCCACTTGCGTCTCATCACTTACAGAACCCTCGCCTTCTGGATGTGTTCATCTTCGTGCTTGCCGACTCCCCATTTCAGTAATGCTTACATGTCAATATGGAAGGTCCGTCCTAATGTGGATGACCTCTGGTCTTATAAGAGACGGCACATGTCACTCCTTAAGGAGTGAAATAGATGTAGAGAGGGTTCTCGGCCTATTCGAGCATTACTGATGCCTAATTACTATGTGTCTCCATATCGTGCGTCAGAAATTCTACACAAGAAATTGGCGTGACTTTACACGATACCCATGCCAATAATAGGCCCCTGACTCACGCAAAAACCCTAAACACCTTCGTCGTTTCGTGTATACTCAGCCAGTCGGCTCGCTCACCCCAATTATGTAGGGCACCCACACCCACGCATTGATGCCGCGGACTTCTACCTGGTAATGTATATTCGATGAACGGATCTGATACCGATCATTAAGGTAACACCGGAACAGATGATAAAGCATTTCCTCTGGCTGGTCATAGTGAAGCAATCAACTGATAAACCGCCTGATACCTCTGTGAGAGTGATAGGCCTCGGTCGGCGCACACACTGCGACTACCATTACGACGTATTGTCCGCCTGTTTCGGCCATGTGCACGACTGTTGTGTGTGTAGGCAGCCACGAAATATGAGGAAGGCTGCTCGCTCACAACCAGGCGAAGAATGGTTGGTCGGCACTGCTATTTAAATAGCGTTGTGCACACCACCGCTTTGTGTGGATTGCCTGCATTGGTGTGTCAGAGTCGGAAGTCTCAGGCACTGTCCTCATGTCAACGCGTCATAAGAACTCGTACAGCTTCTAGACTCTGTGTGTACCGTCCTCAATAAAGAACTTCGGATTATGCACCCTAGCCTCGAGGGACATAGTCACATGGTGGTCTCTCGGGGTCAACCTTCGTACCGCGATGGAAAAAGTAGGTGCACACTCACTAGCCGACTCGTAGCGAGCCTGATAAGAAGAATATCTGTATAACTCTAACCTGGAACCTAGGTGCAAAGTTCGTCTGAATCTGTTGATATCGCCAAGATTCAGTTTGCCGAACTCGATAATTCATCCGTCCCCCCGGCGATCTGGGTCGAGGTTTGGAGGCTCAGGAACGCCTGCATAGCCTAGCATGTAGCACGCGAGACTTATTTACCGGCTACGATCGCGAACCGCATCAAGTCGTAGAAAGACCTTCATGGAGCTTTTCTATGGTTATATCAGGAAAGTGACGGGACGTAACACGATGGGTATCGGCGGTGGCTTCCCTCTAATCTATTGTTTGCTACCTATTCGCTCTTTAACAAAGCTCCCGGCTTCAAAGTCCGCCTCGAGCGTCCGTGGTTCCGGATCCTAGTCTAATGAAACTATGCGTCGACCTAAGCACACTCCAATCATATCTATTATTCCCTATTATTATCTGATTGCGACCAGCGGCGTACTTCCTAAGGCTCACTTTAGAACCGAGGTACTAGCAACATGAATATTAACGTCATGAGGCCGGTTCTGTGGACTCTAGCCCGTTCTATCCAATGAGTCTAAGCACTCATTGGTTTGTCGCGAGCCCTTGTCTAGGGGCTCACTAACGCCAGGCTCTGATGTTTCGTTATTGTTCGGATTCGTAACATCTGCAAATATAAGACTACGACCAACCCGCCAGCAACCTCCGAGACGTTTCCAGAACTTGTGCAACAACTTGAAACGGGATATCTGCCACATGCCCTGAATTCCTTATTCACCCGTGTCTTATATTCGCTGGGGAGACTCCCAGAACTATTTCGAACGGACCCCGTCAGCGGTATTTCGTTTCATGGGCTGATGCTTGGAGGAGGTCAATAATCTTCTTCGGAGACTGAAGAGAGCCTCGGGTAGCCTATATCCCTGTCTGGCCGTGCGCCTGTTGCGCGAGAGCATTCAACGCTTCGGAAACAATTTGTACCTCGTATCTGAAGTTTCTTCGGCGCTCCTGTCCCGGACGAGTGCGTCCCGATCCTTTTAACCAGGGCCGCTGAGATAACATTCTAGGAGTAAAGCGTAATGGCTTGTGCGCGACGAGCCCAACTACATATGTATGTTCTGGCGGCGACCAAAATTAGGTGGCGAGGCTACCGTCCTGTGGAACCCCCACGATAATGATATCGCCGACGACTGGGTTATTTTCGCACTATTCTTGTAATTGCTAGCATGCAAGTGGTCAGTCCTTGGTATGTATCTAACCCCTCCGAGACAAGGCTCGAGCAATATCAAGACAACACCTTAGCCTATCTGTTCCCAATCAACAATTCAAT");

    TSuffTree tree(input);
    TSuffArray array(tree.CreateSuffArray(), input);

    auto start = std::chrono::high_resolution_clock::now();
    while (std::cin >> input) {
        array.Find(input);
    }
    auto stop = std::chrono::high_resolution_clock::now();
    std::cout << std::chrono::duration_cast<std::chrono::microseconds>(stop - start).count() << std::endl;
}
